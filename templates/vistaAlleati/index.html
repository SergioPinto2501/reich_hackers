<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/images/icon/favicon.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_index.css') }}">
    <title>Alleati: World War II</title>
    <style>

        html, body {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            background-color: black;
            color: #8892b0;
            overflow: hidden;
            height: 100%;
        }

        .dropdown-menu {
            background-color: black;
        }
        .dropdown-item {
            color: #ccd6f6;
        }
        .dropdown-item:hover {
            background-color: black;
            color: #fff;
        }
        .content {
            height: calc(100% - 120px);
            padding-top: 60px;
        }
        #map {
            width: 100%;
            height: 100%;
            background: black;
        }
        .leaflet-container {
            background-color: black !important;
        }
        #footer {
            position: fixed;
            left: 50%;
            bottom: 10px;
            transform: translateX(-50%);
            width: 80%;
            background-color:black ;
            padding: 10px;
            display: flex;
            justify-content: space-around;
            border-top: 2px solid black;
            border-radius: 10px;
            z-index: 1000;
        }
        .icon {
            color: #ccd6f6;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .icon:hover {
            color: black;
            transform: scale(1.1);
        }
        .info-panel {
            position: absolute;
            top: 70px;
            right: 10px;
            background: black;
            color: #ccd6f6;
            padding: 10px;
            border-radius: 5px;
            max-width: 300px;
            z-index: 1000;
            border: 1px solid black;
        }
    </style>
</head>
<body>
<canvas id="network-background"></canvas>
<nav class="navbar navbar-expand-lg navbar-dark">
  <a class="navbar-brand" href="/">Reich Hackers</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      {% if 'user' in session %}
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
         Fazione {{ player.faction }}, di {{ player.username }}
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Il mio Profilo</a>
          <a class="dropdown-item" href="#">Abbandona</a>
        </div>
        <div class="resource-of-player" aria-labelledby="navbarDropdown">
            <p class="dropdown-item">Risorse: {{ player.ByteCoin }}</p>
        <div>
      </li>
      {% endif %}
    </ul>
  </div>
</nav>

<div class="content">
    <div id="map"></div>
    <div class="info-panel" id="info">
        <h2>Informazioni Nodo</h2>
        <p>Clicca su un nodo per visualizzare le informazioni.</p>
    </div>
</div>

<div id="footer" class="footer">
        <i class="fas fa-desktop icon" onclick="alert('Opening virtual desktop...')"></i>
        <i class="fas fa-network-wired icon" onclick="alert('Network status...')"></i>
        <i class="fas fa-shield-alt icon" onclick="alert('Defense systems...')"></i>
        <i class="fas fa-virus icon" onclick="alert('Malware toolkit...')"></i>
</div>

<script src="/static/js/canvas_background.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
<script>
    var map = L.map('map', {
        zoomControl: true,
        attributionControl: false,
        minZoom: 2,
        maxZoom: 6,
        dragging: true
    }).setView([20, 0], 2);

    // Set the bounds to restrict movement within the map's viewable area along the y-axis
    var southWest = L.latLng(-90, -180);
    var northEast = L.latLng(90, 180);
    var bounds = L.latLngBounds(southWest, northEast);

    map.setMaxBounds(bounds);
    map.on('drag', function() {
        map.panInsideBounds(bounds, { animate: false });
    });

    // Add a tile layer to the map (OpenStreetMap tiles)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        maxZoom: 19
    }).addTo(map);

    // Example nodes
    const nodes = [
        {lat: 40.7128, lon: -74.0060, name: "New York Node", info: "Principale hub di comunicazione per il Nord America"},
        {lat: 51.5074, lon: -0.1278, name: "London Node", info: "Centro di controllo europeo"},
        {lat: 35.6762, lon: 139.6503, name: "Tokyo Node", info: "Nodo di sicurezza per l'Asia orientale"},
        {lat: -33.8688, lon: 151.2093, name: "Sydney Node", info: "Punto di accesso per l'Oceania"},
        {lat: -1.2921, lon: 36.8219, name: "Nairobi Node", info: "Hub di comunicazione per l'Africa orientale"}
    ];

    const info = document.getElementById('info');

    nodes.forEach(node => {
        L.circleMarker([node.lat, node.lon], {
            radius: 6,
            fillColor: "#3b82f6",
            color: "#fff",
            weight: 2,
            opacity: 1,
            fillOpacity: 0.8
        }).addTo(map).on('click', () => {
            info.innerHTML = `<h2>${node.name}</h2><p>${node.info}</p>`;
        });
    });
</script>
</body>
</html>

